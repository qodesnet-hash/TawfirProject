# ========================================
# Secure Static Files Configuration
# ØªÙƒÙˆÙŠÙ† Ø¢Ù…Ù† Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©
# ========================================

location /static/ {
    alias /var/www/html/static/;
    
    # ====================================
    # ğŸ›¡ï¸ Ù…Ù†Ø¹ ØªÙ†ÙÙŠØ° Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª Ø§Ù„Ø®Ø·Ø±Ø©
    # ====================================
    location ~* \.(php|phtml|php3|php4|php5|php7|phps|cgi|pl|py|jsp|asp|aspx|shtml|sh|exe|bat|bin)$ {
        deny all;
        return 404;
    }
    
    # ====================================
    # ğŸ–¼ï¸ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
    # ====================================
    location ~* \.(jpg|jpeg|png|gif|svg|webp|ico|bmp)$ {
        expires 30d;
        add_header Cache-Control "public, immutable";
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-Frame-Options "SAMEORIGIN" always;
        
        # Ù…Ù†Ø¹ Ø³Ø±Ù‚Ø© Ø§Ù„Ù€ Bandwidth
        valid_referers none blocked server_names tawfir.app *.tawfir.app;
        if ($invalid_referer) {
            return 403;
        }
        
        access_log off;
        log_not_found off;
    }
    
    # ====================================
    # ğŸ“ CSS & JavaScript
    # ====================================
    location ~* \.(css|js)$ {
        expires 7d;
        add_header Cache-Control "public, must-revalidate";
        add_header X-Content-Type-Options "nosniff" always;
        access_log off;
    }
    
    # ====================================
    # ğŸ”¤ Fonts
    # ====================================
    location ~* \.(woff|woff2|ttf|eot|otf)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin "*";
        access_log off;
    }
    
    # ====================================
    # ğŸš« Ù…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
    # ====================================
    location ~* \.(htaccess|htpasswd|ini|log|conf|bak|sql|git|env|old|backup|tmp|temp)$ {
        deny all;
        return 404;
    }
    
    # ====================================
    # ğŸš« Ù…Ù†Ø¹ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
    # ====================================
    location ~ /\. {
        deny all;
        return 404;
    }
    
    # ====================================
    # ğŸ”’ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©
    # ====================================
    autoindex off;  # Ù…Ù†Ø¹ Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
    client_max_body_size 5M;  # Ø­Ø¯ Ø£Ù‚ØµÙ‰ 5MB Ù„Ù„Ù…Ù„Ù
    
    # Security Headers
    add_header X-Robots-Tag "noindex, nofollow" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;
}
